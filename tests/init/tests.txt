*** Settings ***
Resource   lib/vomslib.txt
Resource   lib/variables.txt
Documentation  Generic tests for voms-proxy-init

*** Test Cases ***

Voms proxy init correctly handles missing keygen extension in certificate
  [Documentation]   A regression test for bug https://savannah.cern.ch/bugs/?91183
  [Tags]   regression
  [Setup]   Use certificate   no_key_usage
  Create plain proxy
  ${output}   Execute and Check Success   voms-proxy-info -keyusage
  Should End With   ${output}   key usage :${SPACE}  
  [Teardown]   Stop using certificate

Voms proxy init correctly handles present keygen extension in certificate
  [Documentation]   A regression test for bug https://savannah.cern.ch/bugs/?91183
  [Tags]   regression
  [Setup]   Use certificate   test0
  Create plain proxy
  ${output}   Execute and Check Success   voms-proxy-info -keyusage
  Should End With   ${output}   key usage : Digital Signature, Key Encipherment
  [Teardown]   Stop using certificate

See if voms-proxy-init --version returns after displaying the version
  ${output}  Create Proxy  --version
  Should Match Regexp  ${output}  voms-proxy-init v. \\w

See if voms-proxy-init correctly set unlimited pathLen by default for rfc proxies
  [Documentation]   Regression test for https://issues.infn.it:8443/browse/VOMS-256
  [Tags]   debug
  [Setup]   Use certificate   test0
  Create Proxy   --rfc
  ${output}   Get proxy openssl
  Should Match Regexp   ${output}  Path Length Constraint: infinite 
  [Teardown]  Stop using certificate

See if voms-proxy-init correctly set pathLen as requested 
  [Documentation]   Regression test for https://issues.infn.it:8443/browse/VOMS-256
  [Tags]   debug
  [Setup]   Use certificate   test0
  Create Proxy   --rfc --path_length 1
  ${output}   Get proxy openssl
  Should Match Regexp   ${output}   Path Length Constraint: 01
  [Teardown]  Stop using certificate
